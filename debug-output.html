<!DOCTYPE html><html lang='fr'><head><meta charset='UTF-8'><title>Debug Commande</title><style>body{font-family:Arial,sans-serif;margin:20px;} .debug{background:#f5f5f5;padding:15px;margin:10px 0;border-left:4px solid #007cba;} .error{border-left-color:#dc3545;background:#f8d7da;} .success{border-left-color:#28a745;background:#d4edda;}</style></head><body><h1>ðŸ”§ Debug CrÃ©ation de Commande</h1><div class='debug'><h3>ðŸ“‹ Test 1: Structure de la table Commandes</h3><table border='1' cellpadding='5'><tr><th>Champ</th><th>Type</th><th>Null</th><th>Key</th><th>Default</th></tr><tr><td>CommandeID</td><td>int</td><td>NO</td><td>PRI</td><td>NULL</td></tr><tr><td>UtilisateurID</td><td>int</td><td>YES</td><td>MUL</td><td>NULL</td></tr><tr><td>ReservationID</td><td>int</td><td>YES</td><td>MUL</td><td>NULL</td></tr><tr><td>MenuID</td><td>int</td><td>YES</td><td>MUL</td><td>NULL</td></tr><tr><td>Quantite</td><td>int</td><td>NO</td><td></td><td>1</td></tr><tr><td>DateCommande</td><td>datetime</td><td>YES</td><td></td><td>CURRENT_TIMESTAMP</td></tr><tr><td>Statut</td><td>varchar(50)</td><td>YES</td><td></td><td>En attente</td></tr><tr><td>MontantTotal</td><td>decimal(10,2)</td><td>NO</td><td></td><td>0.00</td></tr><tr><td>NomClient</td><td>varchar(100)</td><td>YES</td><td></td><td>NULL</td></tr><tr><td>PrenomClient</td><td>varchar(100)</td><td>YES</td><td></td><td>NULL</td></tr><tr><td>EmailClient</td><td>varchar(100)</td><td>YES</td><td></td><td>NULL</td></tr><tr><td>TelephoneClient</td><td>varchar(20)</td><td>YES</td><td></td><td>NULL</td></tr><tr><td>AdresseLivraison</td><td>text</td><td>YES</td><td></td><td>NULL</td></tr><tr><td>ModePaiement</td><td>varchar(50)</td><td>YES</td><td></td><td>NULL</td></tr><tr><td>DatePaiement</td><td>datetime</td><td>YES</td><td></td><td>NULL</td></tr><tr><td>PrixUnitaire</td><td>decimal(10,2)</td><td>YES</td><td></td><td>NULL</td></tr><tr><td>NumeroSuivi</td><td>varchar(50)</td><td>YES</td><td></td><td>NULL</td></tr></table><p style='color:green'>âœ“ Table Commandes accessible</p></div><div class='debug'><h3>ðŸ“‹ Test 2: Structure de la table DetailsCommande</h3><table border='1' cellpadding='5'><tr><th>Champ</th><th>Type</th><th>Null</th><th>Key</th><th>Default</th></tr><tr><td>DetailID</td><td>int</td><td>NO</td><td>PRI</td><td>NULL</td></tr><tr><td>CommandeID</td><td>int</td><td>NO</td><td>MUL</td><td>NULL</td></tr><tr><td>MenuID</td><td>int</td><td>NO</td><td>MUL</td><td>NULL</td></tr><tr><td>NomItem</td><td>varchar(100)</td><td>NO</td><td></td><td>NULL</td></tr><tr><td>Prix</td><td>decimal(10,2)</td><td>NO</td><td></td><td>NULL</td></tr><tr><td>Quantite</td><td>int</td><td>NO</td><td></td><td>1</td></tr><tr><td>SousTotal</td><td>decimal(10,2)</td><td>NO</td><td></td><td>NULL</td></tr></table><p style='color:green'>âœ“ Table DetailsCommande accessible</p></div><div class='debug'><h3>ðŸ§ª Test 3: Simulation d'insertion de commande</h3><p><strong>SQL Ã  exÃ©cuter:</strong></p><pre>
        INSERT INTO Commandes (
            UtilisateurID, NomClient, PrenomClient, TelephoneClient, EmailClient, 
            AdresseLivraison, InstructionsSpeciales, ModeLivraison, ModePaiement, 
            MontantTotal, StatutCommande, DateCommande
        ) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, &#039;en_attente&#039;, NOW())
    </pre><p><strong>DonnÃ©es:</strong></p><pre>Array
(
    [user_id] => 
    [nom] => Test
    [prenom] => Debug
    [telephone] => 0123456789
    [email] => test@debug.com
    [adresse] => 123 Rue Test
    [instructions] => Test debug
    [mode_livraison] => livraison
    [mode_paiement] => especes
    [total] => 1000
)
</pre><p style='color:red'>âœ— Exception lors du test: SQLSTATE[42S22]: Column not found: 1054 Unknown column 'InstructionsSpeciales' in 'field list'</p><p><strong>Trace:</strong></p><pre>#0 /Users/flamingo/Documents/GitHub/restaurant-la-mangeoire/debug-commande.php(92): PDO->prepare('\n        INSERT...')
#1 {main}</pre></div><div class='debug'><h3>ðŸ›’ Test 4: Ã‰tat du panier actuel</h3><p>Utilisateur non connectÃ©</p><p style='color:orange'>âš  Panier session vide</p></div><div class='debug'><h3>ðŸ”— Test 5: Contraintes de base de donnÃ©es</h3><table border='1' cellpadding='5'><tr><th>Table</th><th>Colonne</th><th>RÃ©fÃ©rence Table</th><th>RÃ©fÃ©rence Colonne</th></tr><tr><td>Panier</td><td>MenuID</td><td>Menus</td><td>MenuID</td></tr><tr><td>Panier</td><td>UtilisateurID</td><td>Utilisateurs</td><td>UtilisateurID</td></tr><tr><td>DetailsCommande</td><td>CommandeID</td><td>Commandes</td><td>CommandeID</td></tr><tr><td>DetailsCommande</td><td>MenuID</td><td>Menus</td><td>MenuID</td></tr><tr><td>Commandes</td><td>ReservationID</td><td>Reservations</td><td>ReservationID</td></tr><tr><td>Commandes</td><td>MenuID</td><td>Menus</td><td>MenuID</td></tr><tr><td>Commandes</td><td>UtilisateurID</td><td>Utilisateurs</td><td>UtilisateurID</td></tr></table></div><div class='debug'><h3>ðŸ”§ Actions recommandÃ©es</h3><p>Si les tests ci-dessus rÃ©vÃ¨lent des problÃ¨mes :</p><ul><li>VÃ©rifiez que toutes les tables existent avec les bonnes colonnes</li><li>VÃ©rifiez que les clÃ©s Ã©trangÃ¨res sont correctes</li><li>Testez avec des donnÃ©es simples</li><li>VÃ©rifiez les logs d'erreur PHP</li></ul><a href='passer-commande.php' style='background:#007bff;color:white;padding:10px;text-decoration:none;border-radius:3px'>Retourner Ã  la commande</a></div><hr><p><em>Debug effectuÃ© le 2025-06-23 01:46:23</em></p></body></html>