<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ðŸ”§ Diagnostic Bouton Burger Mobile</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.0/font/bootstrap-icons.css" rel="stylesheet">
    <link rel="stylesheet" href="assets/css/admin-sidebar.css">
    <style>
        .diagnostic-panel {
            position: fixed;
            top: 10px;
            right: 10px;
            width: 300px;
            background: white;
            border: 2px solid #007bff;
            border-radius: 10px;
            padding: 15px;
            z-index: 10000;
            font-size: 12px;
            max-height: 400px;
            overflow-y: auto;
        }
        .test-result {
            margin: 5px 0;
            padding: 5px;
            border-radius: 3px;
        }
        .success { background: #d4edda; color: #155724; }
        .error { background: #f8d7da; color: #721c24; }
        .info { background: #d1ecf1; color: #0c5460; }
        .burger-test-btn {
            background: #28a745;
            color: white;
            border: none;
            padding: 8px 15px;
            border-radius: 5px;
            margin: 5px;
            cursor: pointer;
        }
    </style>
</head>
<body>
    <!-- Panel de diagnostic -->
    <div class="diagnostic-panel">
        <h6>ðŸ”§ Diagnostic Burger Mobile</h6>
        <div id="diagnostic-results"></div>
        <hr>
        <button class="burger-test-btn" onclick="testBurgerManually()">ðŸ§ª Test Manuel</button>
        <button class="burger-test-btn" onclick="resetTest()">ðŸ”„ Reset</button>
    </div>

    <!-- Simulation de l'interface admin -->
    <!-- Bouton burger -->
    <button id="admin-burger-btn" class="admin-burger-btn" aria-label="Ouvrir le menu">
        <i class="bi bi-list"></i>
    </button>

    <!-- Sidebar -->
    <div id="admin-sidebar" class="admin-sidebar">
        <div class="logo">La Mangeoire</div>
        <nav>
            <ul>
                <li><a href="#"><i class="bi bi-house"></i> Tableau de bord</a></li>
                <li><a href="#"><i class="bi bi-people"></i> Clients</a></li>
                <li><a href="#"><i class="bi bi-basket"></i> Commandes</a></li>
                <li><a href="#"><i class="bi bi-envelope"></i> Messages</a></li>
            </ul>
        </nav>
    </div>

    <!-- Overlay -->
    <div id="admin-sidebar-overlay" class="admin-sidebar-overlay"></div>

    <!-- Contenu principal -->
    <div class="admin-main-content">
        <div style="padding: 20px;">
            <h1>Test du Bouton Burger Mobile</h1>
            <p>Redimensionnez votre fenÃªtre pour tester sur mobile (largeur &lt; 992px)</p>
            <p>Largeur actuelle: <span id="current-width"></span>px</p>
        </div>
    </div>

    <script>
        const diagnosticResults = document.getElementById('diagnostic-results');
        let testResults = [];

        function addResult(test, status, message) {
            testResults.push({test, status, message});
            updateDiagnostic();
        }

        function updateDiagnostic() {
            diagnosticResults.innerHTML = testResults.map(result => 
                `<div class="test-result ${result.status}">
                    <strong>${result.test}:</strong> ${result.message}
                </div>`
            ).join('');
        }

        function updateWidth() {
            document.getElementById('current-width').textContent = window.innerWidth;
        }

        function runDiagnostic() {
            testResults = [];
            
            // Test 1: Ã‰lÃ©ments DOM prÃ©sents
            const burgerBtn = document.getElementById('admin-burger-btn');
            const sidebar = document.getElementById('admin-sidebar');
            const overlay = document.getElementById('admin-sidebar-overlay');

            addResult('Bouton Burger', burgerBtn ? 'success' : 'error', 
                burgerBtn ? 'TrouvÃ©' : 'Element manquant');
            
            addResult('Sidebar', sidebar ? 'success' : 'error', 
                sidebar ? 'TrouvÃ©' : 'Element manquant');
            
            addResult('Overlay', overlay ? 'success' : 'error', 
                overlay ? 'TrouvÃ©' : 'Element manquant');

            // Test 2: Classes CSS
            if (sidebar) {
                const hasOpenClass = sidebar.classList.contains('open');
                addResult('Sidebar State', 'info', 
                    hasOpenClass ? 'Ouverte' : 'FermÃ©e');
            }

            if (overlay) {
                const hasActiveClass = overlay.classList.contains('active');
                addResult('Overlay State', 'info', 
                    hasActiveClass ? 'Active' : 'Inactive');
            }

            // Test 3: Styles CSS appliquÃ©s
            if (burgerBtn) {
                const styles = getComputedStyle(burgerBtn);
                const isVisible = styles.display !== 'none';
                addResult('Bouton Visible', isVisible ? 'success' : 'error', 
                    `Display: ${styles.display}`);
            }

            // Test 4: Responsive
            const isMobile = window.innerWidth < 992;
            addResult('Mode Mobile', isMobile ? 'info' : 'info', 
                isMobile ? 'Oui (< 992px)' : 'Non (â‰¥ 992px)');

            // Test 5: Event Listeners
            const hasClickEvent = burgerBtn?._clickListenerAttached;
            addResult('Event Listener', 'info', 
                'VÃ©rification manuelle requise');
        }

        function testBurgerManually() {
            const burgerBtn = document.getElementById('admin-burger-btn');
            const sidebar = document.getElementById('admin-sidebar');
            const overlay = document.getElementById('admin-sidebar-overlay');

            if (burgerBtn && sidebar && overlay) {
                // Simuler le clic
                sidebar.classList.toggle('open');
                overlay.classList.toggle('active');
                
                addResult('Test Manuel', 'success', 
                    sidebar.classList.contains('open') ? 'Sidebar ouverte' : 'Sidebar fermÃ©e');
            } else {
                addResult('Test Manuel', 'error', 'Ã‰lÃ©ments manquants');
            }
        }

        function resetTest() {
            const sidebar = document.getElementById('admin-sidebar');
            const overlay = document.getElementById('admin-sidebar-overlay');
            
            if (sidebar) sidebar.classList.remove('open');
            if (overlay) overlay.classList.remove('active');
            
            runDiagnostic();
            addResult('Reset', 'success', 'Interface rÃ©initialisÃ©e');
        }

        // Initialisation
        window.addEventListener('resize', updateWidth);
        updateWidth();
        runDiagnostic();

        // Chargement du script admin-sidebar.js pour tester
        const script = document.createElement('script');
        script.src = 'assets/js/admin-sidebar.js';
        script.onload = () => {
            addResult('Script JS', 'success', 'admin-sidebar.js chargÃ©');
            setTimeout(() => {
                // Re-test aprÃ¨s chargement du script
                runDiagnostic();
            }, 100);
        };
        script.onerror = () => {
            addResult('Script JS', 'error', 'Erreur chargement admin-sidebar.js');
        };
        document.head.appendChild(script);
    </script>
</body>
</html>
